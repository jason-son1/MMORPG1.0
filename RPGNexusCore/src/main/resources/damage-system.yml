# RPGNexusCore Damage System Configuration

# ---------------------------------------------------------
# [ Custom Formula Engine ]
# 사용 가능한 변수:
# - %attacker_STAT% (공격자의 스탯, 소문자)
# - %defender_STAT% (방어자의 스탯, 소문자)
# - 기본 사칙연산 (+, -, *, /) 및 괄호
# - 함수: max(a,b), min(a,b), random(min,max), if(cond, true, false)
# - 논리 연산: >, <, ==, !=, >=, <= (참=1.0, 거짓=0.0)
# ---------------------------------------------------------

# 실제 대미지를 정의하고 구현하는 부분
Damage-System:
    # 대미지의 종류를 정의하는 부분 
    Damage-Category:
        # 1. 공격 방식 (Kind) - 예: 근거리 vs 원거리
        Damage-Kind:
            melee:
                display-name: "&c근거리"
                default-multiplier: 1.0
                description: "무기를 직접 휘둘러 공격합니다."
            ranged:
                display-name: "&a원거리"
                default-multiplier: 0.8
                description: "멀리서 투사체를 발사합니다."

        # 2. 공격 속성 (Sort) - 예: 물리 vs 마법
        Damage-Sort:
            physical:
                display-name: "&7물리"
                default-multiplier: 1.0
            magical:
                display-name: "&b마법"
                default-multiplier: 1.2

        # 3. 공격 출처 (Stem) - 예: 평타, 스킬, 패시브
        Damage-Stem:
            normal:
                display-name: "일반 공격"
                default-multiplier: 1.0
            skill:
                display-name: "스킬 적중"
                default-multiplier: 1.5
            passive:
                display-name: "패시브 효과"
                default-multiplier: 0.5

    # Definitions은 사용할 변수를 정의할 부분 또는 데이터 정의 부분
    Definitions:
        player_attacker_atk: "%player-status#Combat-Ability#$attacker$% OR 0"
        player_defender_def: "%player-status#Defense-Ability#$defender$% OR 0"
        player_crit_chance: "%player-status#Critical#$attacker$% OR 0"
        player_crit_dmg: "%player-status#Critical-Damage#$attacker$% OR 1.5"
    
        # Java에서 넘겨준 damage_mag 변수 사용
        # 대미지를 주는 매커니즘에서 정의되는 대미지값 
        default_damage_mag: "%damage_mag% OR 1.0"
        
        # Java에서 넘겨준 context_multiplier 변수 사용
        # 대미지 카테고리에서 나온 multiplier를 적용한 값
        final_multiplier: "%context_multiplier% OR 1.0"

    # 사용할 변수들을 사용해서 중간 매개 변수 설정 (계산의 용이를 위함)
    Tools:
        pvp_step_crit_success: "if(random(0, 100) < player_crit_chance, 1, 0)"
        pvp_step_defense_ratio: "max(0.1, 1 - (player_defender_def / (player_attacker_atk + 100)))"  
        pvp_step_base_damage: "player_attacker_atk * default_damage_mag"

    # 실제 대미지를 계산하는 부분
    Calculate:
        PVP:
            Final_Damage: "pvp_step_base_damage * (pvp_step_crit_success == 1 ? player_crit_dmg : 1.0) * pvp_step_defense_ratio * final_multiplier"
        PVE:
            Final_Damage: "pvp_step_base_damage * final_multiplier"
        EVP:
            Final_Damage: "default_damage_mag * final_multiplier"
        EVE:
            Final_Damage: "default_damage_mag"